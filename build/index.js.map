{"version":3,"file":"index.js","names":["require","config","isDevelopment","process","env","NODE_ENV","bodyParser","express","http","morgan","swaggerDocs","app","use","req","res","next","header","json","limit","urlencoded","extended","v1","options","controllers","useStubs","port","PORT","swaggerTools","initializeMiddleware","swaggerDoc","middleware","swaggerMetadata","swaggerValidator","swaggerRouter","swaggerUi","createServer","listen","console","log","server"],"sources":["../index.js"],"sourcesContent":["require('dotenv').config();\r\nrequire('babel-register');\r\nconst isDevelopment = process.env.NODE_ENV !== 'production';\r\n\r\n// Main starting point of the application\r\nconst bodyParser = require('body-parser');\r\nconst express = require('express');\r\nconst http = require('http');\r\nconst morgan = require('morgan');\r\nconst { swaggerDocs } = require('./utils/swagger');\r\n\r\nconst app = express();\r\n\r\n// ────────────────────────────────────────────────────────────────────────────────\r\n// ADD CORS\r\n\r\napp.use((req, res, next) => {\r\n  res.header('Access-Control-Allow-Origin', '*');\r\n  res.header(\r\n    'Access-Control-Allow-Methods',\r\n    'GET,PUT,PATCH,POST,DELETE,OPTIONS'\r\n  );\r\n  res.header('Access-Control-Allow-Headers', '*');\r\n  res.header('Access-Control-Allow-Credentials', true);\r\n  next();\r\n});\r\n\r\n// APP SETUP\r\n\r\napp.use(morgan(isDevelopment ? 'dev' : 'combined'));\r\napp.use(bodyParser.json({ limit: '4mb' }));\r\napp.use(bodyParser.urlencoded({ limit: '4mb', extended: true }));\r\n\r\n// Routing\r\n\r\nconst v1 = require('./controllers/v1');\r\napp.use('api/v1', v1);\r\n\r\n// Swagger\r\nconst options = {\r\n  controllers: ['./controllers/v1'],\r\n  useStubs:\r\n    process.env.NODE_ENV === 'development' || process.env.NODE_ENV === 'test',\r\n};\r\nif (process.env.NODE_ENV === 'development' || process.env.NODE_ENV === 'test') {\r\n  const port = process.env.PORT || 3090;\r\n\r\n  // Initialize the Swagger middleware\r\n  swaggerTools.initializeMiddleware(swaggerDoc, (middleware) => {\r\n    // Interpret Swagger resources and attach metadata to request - must\r\n    // be first in swagger-tools middleware chain\r\n    app.use(middleware.swaggerMetadata());\r\n\r\n    // Validate Swagger requests\r\n    app.use(middleware.swaggerValidator());\r\n\r\n    // Route validated requests to appropriate controller\r\n    app.use(middleware.swaggerRouter(options));\r\n\r\n    // Serve the Swagger documents and Swagger UI\r\n    app.use(middleware.swaggerUi());\r\n\r\n    // Start the server\r\n    http.createServer(app).listen(port, async () => {\r\n      console.log('Server listening on: ', port);\r\n      swaggerDocs(app, port);\r\n    });\r\n  });\r\n} else {\r\n  // Server Setup\r\n  const port = process.env.PORT || 3090;\r\n  const server = http.createServer(app);\r\n  server.listen(port, () => {\r\n    console.log('Server listening on: ', port);\r\n  });\r\n}\r\n"],"mappings":"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"}